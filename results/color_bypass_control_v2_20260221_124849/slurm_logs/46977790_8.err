<frozen runpy>:128: RuntimeWarning: 'ollama_color_bypass_bench.hpc.runtime' found in sys.modules after import of package 'ollama_color_bypass_bench.hpc', but prior to execution of 'ollama_color_bypass_bench.hpc.runtime'; this may result in unpredictable behaviour
Traceback (most recent call last):
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connection.py", line 204, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connection.py", line 500, in request
    self.endheaders()
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connection.py", line 331, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connection.py", line 219, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=11434): Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/requests/adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/urllib3/util/retry.py", line 535, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=11434): Max retries exceeded with url: /api/chat (Caused by NewConnectionError("HTTPConnection(host='localhost', port=11434): Failed to establish a new connection: [Errno 111] Connection refused"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/ollama_client.py", line 76, in chat
    response = self._session.post(url, json=payload, timeout=self._timeout_seconds)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/requests/sessions.py", line 637, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zuberi01/miniforge3/envs/llm_ollama/lib/python3.11/site-packages/requests/adapters.py", line 677, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=11434): Max retries exceeded with url: /api/chat (Caused by NewConnectionError("HTTPConnection(host='localhost', port=11434): Failed to establish a new connection: [Errno 111] Connection refused"))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/hpc/runtime.py", line 359, in <module>
    main()
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/hpc/runtime.py", line 354, in main
    result = run_shard(shard_path=args.shard, config_path=args.config, rerun=bool(args.rerun))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/hpc/runtime.py", line 288, in run_shard
    episode_record, turn_records = run_episode(client=client, config=config, job=job)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/episode.py", line 95, in run_episode
    m_message = client.chat(
                ^^^^^^^^^^^^
  File "/mnt/scratchc/fmlab/zuberi01/phd/color-bypass-bench/src/ollama_color_bypass_bench/ollama_client.py", line 91, in chat
    raise OllamaClientError(f"Ollama chat failed after retries for model={model}: {last_error}") from last_error
ollama_color_bypass_bench.ollama_client.OllamaClientError: Ollama chat failed after retries for model=mistral:7b-instruct: HTTPConnectionPool(host='localhost', port=11434): Max retries exceeded with url: /api/chat (Caused by NewConnectionError("HTTPConnection(host='localhost', port=11434): Failed to establish a new connection: [Errno 111] Connection refused"))
